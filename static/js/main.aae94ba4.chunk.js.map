{"version":3,"sources":["store/actions.ts","Map.tsx","utils.ts","TopicBarPlot.tsx","store/reducers/tags.ts","Timeline.tsx","Main.tsx","About.tsx","images/covid19_2.jpg","images/VU_2.png","App.tsx","reportWebVitals.ts","store/reducers/changepoints.ts","store/reducers/loading.ts","store/reducers/index.ts","store/index.ts","index.tsx"],"names":["Action","colorScale","scaleLinear","domain","range","WorldMap","state","data","undefined","loadData","d3","then","console","log","setState","this","className","type","id","aria-expanded","aria-haspopup","xmlns","viewBox","fill","aria-hidden","fillRule","d","clipRule","projectionConfig","rotate","scale","stroke","strokeWidth","length","geography","geographies","map","geo","find","s","ISO3","properties","ISO_A3","Number","rsmKey","React","Component","AttentionType","isSameDate","d1","d2","getFullYear","getMonth","getDate","mapDispatch","incrementLoading","IncrementLoading","decrementLoading","DecrementLoading","connector","connect","currentChangepoint","changepoint","changepoints","tag","TagType","BarPlot","props","container","svg","bounds","update","animated","bbox","node","getBoundingClientRect","width","attr","height","margins","left","top","select","right","sort","x","y","diff","xExtent","typ","Decrease","xScale","selectAll","bottom","transition","duration","call","style","yScale","topic","padding","bars","exit","remove","newBar","enter","append","updated","color","bandwidth","text","animation","delay","i","Math","abs","addBarPlot","window","addEventListener","prevProps","prevState","some","v","increased","decreased","url","Promise","resolve","reject","finally","title","fmtDate","lang","toLowerCase","country","baseUrl","increasedUrl","decreasedUrl","topics","Increase","initialState","activeTags","selectChangepoint","payload","SelectChangepoint","tags","content","interaction","ui","hoverLine","hoverLabel","hoverEnabled","margin","stringencies","Array","from","entries","values","stringency","date","Date","value","StringencyIndex","notes","Notes","pageviews","traffic","t","views","combinedData","yExtentStringency","yScaleStringency","yExtentPageviews","yScalePageviews","stringenciesProj","stringenciesProjContainer","lineID","replaceAll","pageviewsProj","pageviewsProjContainer","stringencyLine","pageviewLine","flat","on","event","current","currentTarget","alreadySelected","classed","labels","each","totalLength","getTotalLength","ease","mouseX","hoveredDate","invert","dist","getTime","stringencyWithNotes","filter","closestIndexWithNotes","a","b","closestDataPoint","Set","n","replace","addTimeline","Map","removeStringencies","keys","includes","removeTopics","forEach","delete","CountryStringency","set","CountryTotal","CountryTopicAttention","addTag","AddTag","removeTag","RemoveTag","tagColor","handleUpdateSearchText","searchText","target","availableTags","LANGUAGE_COUNTRIES","lc","group","base","toUpperCase","has","push","iso3","SELECTED_TOPICS","j","floor","random","temp","shuffleArray","initialSelection","tt","onClick","strokeLinecap","strokeLinejoin","longestPrefix","words","done","substr","searchMatchScorer","query","totalScore","maxScore","maxQi","maxTi","ti","qi","score","splice","searchPrefixes","split","scoredAvailableTags","scoreA","slice","onChange","aria-label","placeholder","tabStyle","to","preventDefault","exact","path","component","TopicBarPlot","About","loadingCount","loading","alt","src","covidLogo","href","vuLogo","Main","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","combineReducers","action","store","createStore","rootReducer","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.aae94ba4.chunk.js","sourcesContent":["enum Action {\n  AddTag,\n  RemoveTag,\n  SelectChangepoint,\n  IncrementLoading,\n  DecrementLoading,\n}\n\nexport { Action };\n","import React from \"react\";\nimport * as d3 from \"d3\";\nimport { scaleLinear } from \"d3-scale\";\nimport {\n  ComposableMap,\n  Geographies,\n  Geography,\n  Sphere,\n  Graticule,\n} from \"react-simple-maps\";\n\nconst geoUrl =\n  \"https://raw.githubusercontent.com/zcreativelabs/react-simple-maps/master/topojson-maps/world-110m.json\";\n\nconst colorScale = scaleLinear<string>()\n  .domain([0.29, 0.68])\n  .range([\"#ffedea\", \"#ff5233\"]);\n\ntype WorldMapProps = {};\n\ntype Cols =\n  | \"ISO3\"\n  | \"Name\"\n  | \"1995\"\n  | \"1996\"\n  | \"1997\"\n  | \"1998\"\n  | \"1999\"\n  | \"2000\"\n  | \"2001\"\n  | \"2002\"\n  | \"2003\"\n  | \"2004\"\n  | \"2005\"\n  | \"2006\"\n  | \"2007\"\n  | \"2008\"\n  | \"2009\"\n  | \"2010\"\n  | \"2011\"\n  | \"2012\"\n  | \"2013\"\n  | \"2014\"\n  | \"2015\"\n  | \"2016\"\n  | \"2017\";\n\ntype WorldMapState = {\n  data: d3.DSVRowArray<Cols> | undefined;\n};\n\nexport default class WorldMap extends React.Component<\n  WorldMapProps,\n  WorldMapState\n> {\n  state: WorldMapState = {\n    data: undefined,\n  };\n\n  loadData = () => {\n    d3.csv<Cols>(\"maptest.csv\").then((data) => {\n      console.log(data);\n      this.setState({\n        data,\n      });\n    });\n  };\n\n  componentDidMount() {\n    this.loadData();\n  }\n\n  render() {\n    return (\n      <div>\n        <div className=\"flex\">\n          <div className=\"w-3/4 inline-block\">\n            <WorldMap />\n          </div>\n          <div className=\"w-1/4 inline-block px-2\">\n            <button\n              type=\"button\"\n              className=\"inline-flex justify-center w-full rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-100 focus:ring-indigo-500\"\n              id=\"menu-button\"\n              aria-expanded=\"true\"\n              aria-haspopup=\"true\"\n            >\n              Options\n              <svg\n                className=\"-mr-1 ml-2 h-5 w-5\"\n                xmlns=\"http://www.w3.org/2000/svg\"\n                viewBox=\"0 0 20 20\"\n                fill=\"currentColor\"\n                aria-hidden=\"true\"\n              >\n                <path\n                  fillRule=\"evenodd\"\n                  d=\"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z\"\n                  clipRule=\"evenodd\"\n                />\n              </svg>\n            </button>\n          </div>\n        </div>\n\n        <ComposableMap\n          projectionConfig={{\n            rotate: [-10, 0, 0],\n            scale: 147,\n          }}\n        >\n          <Sphere id=\"test\" fill=\"blue\" stroke=\"#E4E5E6\" strokeWidth={0.5} />\n          <Graticule stroke=\"#E4E5E6\" strokeWidth={0.5} />\n          {(this.state.data?.length ?? 0) > 0 && (\n            <Geographies geography={geoUrl}>\n              {({ geographies }) =>\n                geographies.map((geo) => {\n                  const d = this.state.data?.find(\n                    (s) => s.ISO3 === geo.properties.ISO_A3\n                  );\n                  return (\n                    <Geography\n                      key={geo.rsmKey}\n                      geography={geo}\n                      fill={d ? colorScale(Number(d[\"2017\"])) : \"#F5F4F6\"}\n                    />\n                  );\n                })\n              }\n            </Geographies>\n          )}\n        </ComposableMap>\n      </div>\n    );\n  }\n}\n","export type Country = {\n  code: string;\n  group: string;\n  name: string;\n};\n\nexport const shuffleArray = (a: any[]): void => {\n  for (let i = a.length - 1; i > 0; i--) {\n    const j = Math.floor(Math.random() * (i + 1));\n    const temp = a[i];\n    a[i] = a[j];\n    a[j] = temp;\n  }\n};\n\nexport const isSameDate = (\n  d1: Date | null | undefined,\n  d2: Date | null | undefined\n): boolean => {\n  if (d1 === null || d1 === undefined) return false;\n  if (d2 === null || d2 === undefined) return false;\n  return (\n    d1.getFullYear() === d2.getFullYear() &&\n    d1.getMonth() === d2.getMonth() &&\n    d1.getDate() === d2.getDate()\n  );\n};\n","import React from \"react\";\nimport * as d3 from \"d3\";\nimport { connect, ConnectedProps } from \"react-redux\";\nimport { Action } from \"./store/actions\";\nimport { RootState } from \"./store\";\nimport { isSameDate, Country } from \"./utils\";\n\nconst mapState = (state: RootState) => ({\n  currentChangepoint: {\n    changepoint: state.changepoints?.changepoint,\n    tag: state.changepoints?.tag,\n  },\n});\n\nconst mapDispatch = {\n  incrementLoading: () => ({\n    type: Action.IncrementLoading,\n  }),\n  decrementLoading: () => ({\n    type: Action.DecrementLoading,\n  }),\n};\n\nconst connector = connect(mapState, mapDispatch);\ntype PropsFromRedux = ConnectedProps<typeof connector>;\n\nenum AttentionType {\n  Increase,\n  Decrease,\n}\n\ntype TopicDiff = { topic: string; diff: number };\n\ntype Diff = {\n  changepoint: Date;\n  country: Country;\n  topics: TopicDiff[];\n};\n\ntype Margins = {\n  top: number;\n  right: number;\n  bottom: number;\n  left: number;\n};\n\ntype BarPlotProps = {\n  data: TopicDiff[];\n  id: string;\n  color: string;\n  typ: AttentionType;\n  height: number;\n  margins: Margins;\n};\n\ntype BarPlotState = {};\n\nclass BarPlot extends React.Component<BarPlotProps, BarPlotState> {\n  container!: d3.Selection<HTMLDivElement, any, HTMLElement, any>;\n  svg!: d3.Selection<SVGSVGElement, any, HTMLElement, any>;\n  bounds!: d3.Selection<SVGGElement, any, HTMLElement, any>;\n\n  constructor(props: BarPlotProps) {\n    super(props);\n    this.state = {};\n  }\n\n  update = (animated: boolean = false) => {\n    console.log(\"update barplots\");\n\n    const bbox = this.container?.node()?.getBoundingClientRect();\n    const width = bbox?.width ?? 0;\n\n    this.svg.attr(\"width\", width).attr(\"height\", this.props.height);\n    this.bounds.attr(\n      \"transform\",\n      `translate(${this.props.margins.left}, ${this.props.margins.top})`\n    );\n    this.bounds\n      .select(\".xLabelBar\")\n      .attr(\n        \"x\",\n        (width - this.props.margins.left - this.props.margins.right) / 2\n      )\n      .attr(\"y\", this.props.height - this.props.margins.top - 10);\n\n    const data = this.props.data.sort((x, y) => {\n      return d3.descending(x.diff, y.diff);\n    });\n\n    // calculate extent\n    let xExtent = d3.extent(data, (d) => d.diff) as [number, number];\n    if (this.props.typ === AttentionType.Decrease) {\n      xExtent = [xExtent[1], xExtent[0]];\n    }\n\n    // X axis\n    const xScale = d3\n      .scaleLinear()\n      .domain(xExtent)\n      .range([0, width - this.props.margins.left - this.props.margins.right]);\n\n    this.bounds\n      .selectAll<SVGGElement, any>(\".xAxis\")\n      .attr(\n        \"transform\",\n        `translate(0, ${\n          this.props.height - this.props.margins.bottom - this.props.margins.top\n        })`\n      )\n      .transition()\n      .duration(animated ? 100 : 0)\n      .call(d3.axisBottom(xScale))\n      .selectAll(\"text\")\n      .attr(\"transform\", \"translate(-10,0)rotate(-45)\")\n      .style(\"text-anchor\", \"end\");\n\n    // Y axis\n    const yScale = d3\n      .scaleBand()\n      .range([\n        0,\n        this.props.height - this.props.margins.bottom - this.props.margins.top,\n      ])\n      .domain(data.map((d) => d.topic))\n      .padding(0.1);\n\n    this.bounds\n      .selectAll<SVGGElement, any>(\".yAxis\")\n      .transition()\n      .duration(animated ? 100 : 0)\n      .call(d3.axisLeft(yScale))\n      .selectAll(\"text\")\n      .style(\"text-anchor\", \"end\");\n\n    // Bars\n    const bars = this.bounds\n      .selectAll<SVGRectElement, TopicDiff>(\".bar\")\n      .data<TopicDiff>(data);\n\n    bars.exit().remove();\n    const newBar = bars.enter().append(\"g\").attr(\"class\", \"bar\");\n\n    newBar.append(\"rect\");\n    newBar.append(\"text\");\n\n    const updated = this.bounds.selectAll<SVGRectElement, TopicDiff>(\".bar\");\n\n    updated\n      .select(\"rect\")\n      .attr(\"x\", 0)\n      .attr(\"y\", (d) => yScale(d.topic) ?? 0)\n      .attr(\"fill\", this.props.color)\n      .attr(\"height\", yScale.bandwidth())\n      .attr(\"width\", (d) => 0);\n\n    updated\n      .select(\"text\")\n      .attr(\"class\", \"barLabel\")\n      .attr(\"opacity\", 0)\n      .style(\"font-size\", \"12px\")\n      .attr(\"text-anchor\", \"end\")\n      .attr(\"alignment-baseline\", \"middle\")\n      .attr(\"x\", 0)\n      .attr(\"y\", (d) => (yScale(d.topic) ?? 0) + 0.5 * yScale.bandwidth())\n      .text(\"\"); // todo: show percentual increase?\n\n    const animation = this.bounds\n      .selectAll<SVGRectElement, TopicDiff>(\".bar\")\n      .transition()\n      .duration(animated ? 800 : 0)\n      .delay((d, i) => (animated ? i * 100 : 0));\n\n    animation.select(\"rect\").attr(\"width\", (d) => xScale(d.diff));\n\n    animation\n      .select(\"text\")\n      .attr(\"opacity\", (d) => (Math.abs(xScale(d.diff)) > 30 ? 1 : 0))\n      .attr(\"x\", (d) => xScale(d.diff));\n  };\n\n  addBarPlot = () => {\n    this.container = d3.select<HTMLDivElement, any>(\n      `#barplot-${this.props.id}-container`\n    );\n\n    this.svg = this.container.append(\"svg\");\n    this.bounds = this.svg.append(\"g\");\n\n    // add axis\n    this.bounds.append(\"g\").attr(\"class\", \"xAxis\");\n\n    this.bounds\n      .append(\"text\")\n      .attr(\"class\", \"xLabelBar\")\n      .style(\"font-size\", 15)\n      .attr(\"text-anchor\", \"middle\")\n      .text(\"absolute difference page views\");\n\n    this.bounds.append(\"g\").attr(\"class\", \"yAxis\");\n\n    const resize = () => {\n      console.log(\"bar resize\");\n      this.update();\n    };\n    window.addEventListener(\"resize\", resize);\n  };\n\n  componentDidUpdate(prevProps: BarPlotProps, prevState: BarPlotState) {\n    if (\n      this.props.data.length !== prevProps.data.length ||\n      this.props.data.some(\n        (v, i) =>\n          v.topic !== prevProps.data[i].topic ||\n          v.diff !== prevProps.data[i].diff\n      )\n    ) {\n      this.update(true);\n    }\n  }\n\n  componentDidMount() {\n    this.addBarPlot();\n    this.update(true);\n  }\n\n  render() {\n    return (\n      <div>\n        <div id={`barplot-${this.props.id}-container`}></div>\n      </div>\n    );\n  }\n}\n\ninterface TopicAttentionProps extends PropsFromRedux {}\n\ntype TopicAttentionState = {\n  increased: Diff | undefined;\n  decreased: Diff | undefined;\n};\n\nclass TopicAttention extends React.Component<\n  TopicAttentionProps,\n  TopicAttentionState\n> {\n  margins = { top: 30, right: 30, bottom: 60, left: 175 };\n  height = 400;\n\n  constructor(props: TopicAttentionProps) {\n    super(props);\n    this.state = {\n      increased: undefined,\n      decreased: undefined,\n    };\n  }\n\n  loadData<D>(url: string): Promise<D> {\n    return new Promise<D>((resolve, reject) => {\n      this.props.incrementLoading();\n      d3.json<D>(url)\n        .then((data) => {\n          if (data === undefined) return reject();\n          resolve(data);\n        })\n        .finally(() => this.props.decrementLoading());\n    });\n  }\n\n  componentDidUpdate(\n    prevProps: TopicAttentionProps,\n    prevState: TopicAttentionState\n  ) {\n    if (\n      !isSameDate(\n        this.props.currentChangepoint.changepoint,\n        prevProps.currentChangepoint.changepoint\n      ) ||\n      this.props.currentChangepoint.tag?.title !==\n        prevProps.currentChangepoint.tag?.title\n    ) {\n      const { tag, changepoint } = this.props.currentChangepoint;\n      if (tag === null || tag === undefined) return;\n      if (changepoint === null || changepoint === undefined) return;\n\n      const fmtDate = d3.timeFormat(\"%Y-%-m-%-d\");\n      const lang = tag.lang.toLowerCase();\n      const country = tag.country.toLowerCase();\n      const baseUrl = `data/${lang}/${country}/changepoints`;\n\n      const increasedUrl = `${baseUrl}/did_${fmtDate(\n        changepoint\n      )}_increased.json`;\n\n      const decreasedUrl = `${baseUrl}/did_${fmtDate(\n        changepoint\n      )}_decreased.json`;\n\n      this.loadData<Diff>(increasedUrl).then((increased) => {\n        this.loadData<Diff>(decreasedUrl).then((decreased) => {\n          this.setState((state) => {\n            return {\n              ...state,\n              increased,\n              decreased,\n            };\n          });\n        });\n      });\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"flex\">\n        <div id=\"barplot-increase-container\" className=\"w-1/2 inline-block\">\n          <BarPlot\n            data={this.state.increased?.topics ?? []}\n            id=\"inc\"\n            height={this.height}\n            color=\"#34D399\"\n            margins={this.margins}\n            typ={AttentionType.Increase}\n          />\n        </div>\n        <div id=\"barplot-decrease-container\" className=\"w-1/2 inline-block\">\n          <BarPlot\n            data={this.state.decreased?.topics ?? []}\n            id=\"dec\"\n            color=\"#F87171\"\n            height={this.height}\n            margins={this.margins}\n            typ={AttentionType.Decrease}\n          />\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default connector(TopicAttention);\n","import { Action } from \"../actions\";\nimport { AnyAction } from \"redux\";\n\nenum TagType {\n  CountryStringency,\n  CountryTopicAttention,\n  CountryTotal,\n}\n\ntype Tag = {\n  typ: TagType;\n  country: string;\n  lang: string;\n  iso3: string;\n  url: string;\n  title: string;\n};\n\ntype TagState = {\n  readonly activeTags: Tag[];\n};\n\nconst initialState: TagState = {\n  activeTags: [],\n};\n\nexport { TagType };\nexport type { TagState, Tag };\n\nexport default function tagReducer(state = initialState, action: AnyAction) {\n  switch (action.type) {\n    case Action.AddTag: {\n      const { tag } = action.payload;\n      return {\n        ...state,\n        activeTags: [...state.activeTags, tag],\n      };\n    }\n    case Action.RemoveTag: {\n      const { tag } = action.payload;\n      return {\n        ...state,\n        activeTags: state.activeTags.filter((t) => t.title !== tag.title),\n      };\n    }\n\n    default:\n      return state;\n  }\n}\n","import React from \"react\";\nimport * as d3 from \"d3\";\nimport { connect, ConnectedProps } from \"react-redux\";\nimport { Action } from \"./store/actions\";\nimport { Tag, TagType } from \"./store/reducers/tags\";\nimport { RootState } from \"./store\";\nimport { isSameDate, Country } from \"./utils\";\n\n// raw stringency JSON type\ntype Stringency = {\n  Date: string;\n  StringencyIndex: number;\n  Notes: string[];\n};\n\n// raw pageview JSON type\ntype Pageview = {\n  date: string;\n  views: string;\n};\n\ntype CountryStringency = {\n  country: Country;\n  changepoints: string[];\n  stringency: Stringency[];\n};\n\ntype CountryTopicAttention = {\n  country: Country;\n  traffic: Pageview[];\n};\n\nconst mapState = (state: RootState) => ({\n  activeTags: state.tags.activeTags,\n  currentChangepoint: state.changepoints?.changepoint,\n});\n\nconst mapDispatch = {\n  selectChangepoint: (payload: {\n    changepoint: Date | undefined;\n    tag: Tag | undefined;\n  }) => ({\n    type: Action.SelectChangepoint,\n    payload,\n  }),\n  incrementLoading: () => ({\n    type: Action.IncrementLoading,\n  }),\n  decrementLoading: () => ({\n    type: Action.DecrementLoading,\n  }),\n};\n\nconst connector = connect(mapState, mapDispatch);\ntype PropsFromRedux = ConnectedProps<typeof connector>;\n\ninterface TimelineProps extends PropsFromRedux {}\n\ntype TimelineState = {\n  stringencies: Map<string, CountryStringency>;\n  topics: Map<string, CountryTopicAttention>;\n  notes: string[];\n};\n\nclass Timeline extends React.Component<TimelineProps, TimelineState> {\n  container!: d3.Selection<HTMLDivElement, any, HTMLElement, any>;\n  svg!: d3.Selection<SVGSVGElement, any, HTMLElement, any>;\n  bounds!: d3.Selection<SVGGElement, any, HTMLElement, any>;\n  content!: d3.Selection<SVGGElement, any, HTMLElement, any>;\n  interaction!: d3.Selection<SVGGElement, any, HTMLElement, any>;\n  ui!: d3.Selection<SVGGElement, any, HTMLElement, any>;\n\n  hoverLine!: d3.Selection<SVGRectElement, any, HTMLElement, any>;\n  hoverLabel!: d3.Selection<SVGTextElement, any, HTMLElement, any>;\n\n  hoverEnabled: boolean = true;\n  margin = { top: 10, right: 60, bottom: 35, left: 30 };\n  height = 300;\n\n  constructor(props: TimelineProps) {\n    super(props);\n    this.state = {\n      stringencies: new Map<string, CountryStringency>(),\n      topics: new Map<string, CountryTopicAttention>(),\n      notes: [],\n    };\n  }\n\n  update = (animated: boolean = false) => {\n    console.log(\"update timeline\");\n    const bbox = this.container?.node()?.getBoundingClientRect();\n    const width = bbox?.width ?? 0;\n\n    this.svg.attr(\"width\", width).attr(\"height\", this.height);\n    this.bounds.attr(\n      \"transform\",\n      `translate(${this.margin.left}, ${this.margin.top})`\n    );\n    this.svg\n      .select(\".listeningRect\")\n      .attr(\"width\", width - this.margin.left - this.margin.right)\n      .attr(\"height\", this.height - this.margin.top - this.margin.bottom);\n\n    this.hoverLabel\n      .attr(\"x\", width - this.margin.left - this.margin.right - 10)\n      .attr(\"y\", this.height - this.margin.top - this.margin.bottom - 10);\n\n    this.hoverLine.attr(\n      \"height\",\n      this.height - this.margin.top - this.margin.bottom\n    );\n\n    // data types\n    type ChangepointGraph = { date: Date; id: string };\n\n    type TimeSeriesDatapoint = {\n      date: Date;\n      value: number;\n    };\n\n    interface StringencyGraphValue extends TimeSeriesDatapoint {\n      notes: string[];\n    }\n\n    type Graph = {\n      id: string;\n      values: TimeSeriesDatapoint[];\n    };\n\n    interface StringencyGraph extends Graph {\n      values: StringencyGraphValue[];\n      changepoints: ChangepointGraph[];\n    }\n\n    interface PageviewGraph extends Graph {}\n\n    const stringencies: StringencyGraph[] = Array.from(\n      this.state.stringencies.entries()\n    ).map(([tag, s]) => {\n      return {\n        id: tag,\n        values: s.stringency.map((d) => {\n          return {\n            date: new Date(d.Date),\n            value: Number(d.StringencyIndex),\n            notes: d.Notes,\n          };\n        }),\n        changepoints: s.changepoints.map((d) => {\n          return { date: new Date(d), id: tag };\n        }),\n      };\n    });\n\n    const pageviews: PageviewGraph[] = Array.from(\n      this.state.topics.entries()\n    ).map(([tag, t]) => {\n      return {\n        id: tag,\n        values: t.traffic.map((t) => {\n          return { date: new Date(t.date), value: Number(t.views) };\n        }),\n      };\n    });\n\n    this.ui\n      .select(\".yLabelStringency\")\n      .attr(\"opacity\", stringencies.length > 0 ? 1 : 0);\n\n    this.ui\n      .select(\".yLabelPageviews\")\n      .attr(\"opacity\", pageviews.length > 0 ? 1 : 0)\n      .attr(\n        \"transform\",\n        `translate(${\n          width - this.margin.left - this.margin.right - 10\n        },0)rotate(-90)`\n      );\n\n    const color = d3\n      .scaleOrdinal(d3.schemeCategory10)\n      .domain([...stringencies, ...pageviews].map((s) => s.id));\n\n    const combinedData = [...stringencies, ...pageviews];\n    const xExtent = [\n      d3.min(combinedData, (s) => d3.min(s.values, (d) => d.date)),\n      d3.max(combinedData, (s) => d3.max(s.values, (d) => d.date)),\n    ] as [Date, Date];\n\n    const xScale = d3\n      .scaleTime()\n      .range([0, width - this.margin.left - this.margin.right])\n      .domain(xExtent);\n\n    this.ui\n      .selectAll<SVGGElement, any>(\".xAxis\")\n      .attr(\n        \"transform\",\n        `translate(0, ${this.height - this.margin.bottom - this.margin.top})`\n      )\n      .transition()\n      .duration(animated ? 100 : 0)\n      .call(d3.axisBottom(xScale))\n      .selectAll(\"text\")\n      .attr(\"transform\", \"translate(-10,0)rotate(-45)\")\n      .style(\"text-anchor\", \"end\");\n\n    // compute the total y domain (stringency and pageviews separately)\n    const yExtentStringency = [\n      d3.min(stringencies, (s) => d3.min(s.values, (d) => d.value)),\n      d3.max(stringencies, (s) => d3.max(s.values, (d) => d.value)),\n    ] as [number, number];\n\n    const yScaleStringency = d3\n      .scaleLinear<number>()\n      .range([this.height - this.margin.top - this.margin.bottom, 0])\n      .domain(yExtentStringency);\n\n    this.ui\n      .selectAll<SVGGElement, any>(\".yAxisStringency\")\n      .transition()\n      .duration(animated ? 100 : 0)\n      .call(d3.axisLeft(yScaleStringency))\n      .selectAll(\"text\")\n      .style(\"text-anchor\", \"end\");\n\n    const yExtentPageviews = [\n      d3.min(pageviews, (s) => d3.min(s.values, (d) => d.value)),\n      d3.max(pageviews, (s) => d3.max(s.values, (d) => d.value)),\n    ] as [number, number];\n\n    const yScalePageviews = d3\n      .scaleLinear<number>()\n      .range([this.height - this.margin.top - this.margin.bottom, 0])\n      .domain(yExtentPageviews);\n\n    this.ui\n      .selectAll<SVGGElement, any>(\".yAxisPageviews\")\n      .attr(\n        \"transform\",\n        `translate(${width - this.margin.left - this.margin.right}, 0)`\n      )\n      .transition()\n      .duration(animated ? 100 : 0)\n      .call(d3.axisRight(yScalePageviews))\n      .selectAll(\"text\")\n      .style(\"text-anchor\", \"start\");\n\n    const stringenciesProj = this.content\n      .selectAll<SVGGElement, StringencyGraph>(\".stringency\")\n      .data(stringencies, (s) => s.id);\n\n    stringenciesProj.exit().remove();\n    const stringenciesProjContainer = stringenciesProj\n      .enter()\n      .append(\"g\")\n      .attr(\"class\", (s) => `stringency ${s.id}`);\n\n    stringenciesProjContainer.append(\"path\").attr(\"class\", \"stringencyLine\");\n\n    const lineID = (title: string) => {\n      return title.toLowerCase().replaceAll(\":\", \"-\");\n    };\n\n    // render topics\n    const pageviewsProj = this.content\n      .selectAll<SVGGElement, PageviewGraph>(\".pageviews\")\n      .data(pageviews, (s) => s.id);\n\n    pageviewsProj.exit().remove();\n    const pageviewsProjContainer = pageviewsProj\n      .enter()\n      .append(\"g\")\n      .attr(\"class\", (s) => `pageviews ${s.id}`);\n\n    pageviewsProjContainer.append(\"path\").attr(\"class\", \"pageviewLine\");\n\n    // plot lines for stringencies\n    const stringencyLine = d3\n      .line<TimeSeriesDatapoint>()\n      .x((d) => xScale(d.date))\n      .y((d) => yScaleStringency(d.value));\n\n    this.content\n      .selectAll<SVGPathElement, Graph>(\".stringencyLine\")\n      .attr(\"stroke-dasharray\", \"3, 3\")\n      .attr(\"fill\", \"none\")\n      .attr(\"id\", (d, i) => lineID(d.id))\n      .attr(\"stroke-width\", 2)\n      .attr(\"stroke-linecap\", \"round\")\n      .attr(\"d\", (d, i) => {\n        return stringencyLine(d.values);\n      })\n      .style(\"stroke\", (d) => color(d.id));\n\n    // plot lines for pageviews\n    const pageviewLine = d3\n      .line<TimeSeriesDatapoint>()\n      .x((d) => xScale(d.date))\n      .y((d) => yScalePageviews(d.value));\n\n    this.content\n      .selectAll<SVGPathElement, Graph>(\".pageviewLine\")\n      .attr(\"fill\", \"none\")\n      .attr(\"id\", (d, i) => lineID(d.id))\n      .attr(\"stroke-width\", 1)\n      .attr(\"stroke-linecap\", \"round\")\n      .attr(\"d\", (d, i) => {\n        return pageviewLine(\n          d.values.sort((x, y) => {\n            return d3.ascending(x.date, y.date);\n          })\n        );\n      })\n      .style(\"stroke\", (d) => color(d.id));\n\n    const changepoints = this.interaction\n      .selectAll<SVGRectElement, ChangepointGraph>(\".changepoint\")\n      .data(stringencies.map((s) => s.changepoints).flat());\n\n    changepoints.exit().remove();\n    changepoints.enter().append(\"rect\").attr(\"class\", \"changepoint\");\n\n    this.interaction\n      .selectAll<SVGRectElement, ChangepointGraph>(\".changepoint\")\n      .attr(\"width\", \"5px\")\n      .attr(\"cursor\", \"pointer\")\n      .attr(\"fill\", (d) => color(d.id))\n      .attr(\"opacity\", \"0.1\")\n      .attr(\"height\", this.height - this.margin.top - this.margin.bottom)\n      .attr(\"x\", (d) => {\n        return xScale(d.date);\n      })\n      .on(\"click\", (event, d) => {\n        const current = d3.select(event.currentTarget);\n        if (\n          this.props.currentChangepoint !== undefined &&\n          !isSameDate(d.date, this.props.currentChangepoint)\n        ) {\n          // must deselect old one\n          d3.selectAll<SVGRectElement, StringencyGraph>(\".changepoint\").attr(\n            \"opacity\",\n            0.1\n          );\n        }\n        const alreadySelected = isSameDate(\n          d.date,\n          this.props.currentChangepoint\n        );\n        current\n          .classed(\"selected\", !alreadySelected)\n          .attr(\"opacity\", (d) => (alreadySelected ? 0.1 : 0.5));\n\n        this.props.selectChangepoint({\n          changepoint: alreadySelected ? undefined : d.date,\n          tag: alreadySelected\n            ? undefined\n            : this.props.activeTags.find((t) => t.title === d.id),\n        });\n      })\n      .on(\"mouseover\", (event, d) => {\n        d3.select(event.currentTarget).attr(\"opacity\", 0.5);\n      })\n      .on(\"mouseout\", (event, d) => {\n        d3.select<SVGRectElement, any>(event.currentTarget).attr(\n          \"opacity\",\n          (d) => (d.date === this.props.currentChangepoint ? 0.5 : 0.1)\n        );\n      });\n\n    // plot legend for both pageviews and stringencies\n    const labels = this.ui\n      .selectAll<SVGGElement, { id: string }>(\".legend\")\n      .data(combinedData, (s) => s.id);\n\n    labels.exit().remove();\n    labels\n      .enter()\n      .append(\"text\")\n      .attr(\"class\", (s) => `legend legend-${s.id}`);\n\n    this.ui\n      .selectAll<SVGTextElement, { id: string }>(\".legend\")\n      .attr(\"text-anchor\", \"start\")\n      .style(\"font-size\", \"10px\")\n      .attr(\"fill\", (d) => color(d.id))\n      .attr(\"x\", this.margin.left + 10)\n      .attr(\"y\", (d, i) => this.margin.top + 5 + 15 * i)\n      .text((d) => d.id);\n\n    // animate to show pageview and stringency graphs\n    this.content.selectAll<SVGPathElement, Graph>(\".line\").each((d, i) => {\n      var totalLength =\n        d3\n          .select<SVGPathElement, Graph>(\"#\" + lineID(d.id))\n          ?.node()\n          ?.getTotalLength() ?? width;\n\n      d3.selectAll(\"#\" + lineID(d.id))\n        .attr(\"stroke-dasharray\", totalLength + \" \" + totalLength)\n        .attr(\"stroke-dashoffset\", totalLength)\n        .transition()\n        .duration(animated ? 1000 : 0)\n        .delay(animated ? 100 * (i + 0) : 0)\n        .ease(d3.easeQuad)\n        .attr(\"stroke-dashoffset\", 0);\n    });\n\n    this.svg\n      .select(\".listeningRect\")\n      .on(\"click\", (event, d) => {\n        // toggle hovering to be able to read about restrictions\n        this.hoverEnabled = !this.hoverEnabled;\n      })\n      .on(\"mousemove\", (event, d) => {\n        if (!this.hoverEnabled) return;\n        const mouseX = d3.pointer(event)[0];\n        const hoveredDate: Date = xScale.invert(mouseX);\n        this.hoverLabel.text(d3.timeFormat(\"%B %d, %Y\")(hoveredDate));\n        this.hoverLine.attr(\"x\", xScale(hoveredDate));\n\n        // only show detailed stringency events if one is plotted\n        if (stringencies.length !== 1) {\n          this.setState({\n            notes: [],\n          });\n          return;\n        }\n\n        const dist = (d: { date: Date }): number =>\n          Math.abs((d.date?.getTime() ?? 0) - hoveredDate.getTime());\n        const firstStringency: StringencyGraph = stringencies[0];\n        const stringencyWithNotes = firstStringency.values.filter(\n          (s) => s.notes.length > 0\n        );\n        const closestIndexWithNotes: number | undefined = d3.leastIndex(\n          stringencyWithNotes,\n          (a, b) => dist(a) - dist(b)\n        );\n        if (closestIndexWithNotes !== undefined) {\n          const closestDataPoint = stringencyWithNotes[closestIndexWithNotes];\n          this.setState({\n            notes: [\n              ...new Set(\n                closestDataPoint?.notes.map((n) => {\n                  const stripped = n.replace(\n                    /(\\(?\\s*(Sources?:\\s*)?(https?:\\/\\/(www\\.)?[-a-zA-Z0-9@:%._\\\\+~#=]{1,256}\\.[a-zA-Z0-9()]{1,6}\\b([-a-zA-Z0-9()@:%_\\\\+.~#?&//=]*)\\s*)+\\)?)/gim,\n                    \" [...] \"\n                  );\n                  return stripped;\n                }) ?? []\n              ),\n            ],\n          });\n        }\n      });\n  };\n\n  addTimeline = () => {\n    this.container = d3.select<HTMLDivElement, any>(\"#timeline-container\");\n    this.svg = this.container.append(\"svg\").attr(\"x\", 0).attr(\"y\", 0);\n\n    this.bounds = this.svg.append(\"g\");\n\n    // static graphs\n    this.content = this.bounds.append(\"g\");\n\n    // readable ui code, legends\n    this.ui = this.bounds.append(\"g\");\n\n    // for controlling the hover effects\n    this.bounds\n      .append(\"rect\")\n      .attr(\"class\", \"listeningRect\")\n      .attr(\"fill\", \"transparent\");\n\n    // changepoints must be selecable\n    this.interaction = this.bounds.append(\"g\");\n\n    this.ui.append(\"g\").attr(\"class\", \"xAxis\");\n    this.ui.append(\"g\").attr(\"class\", \"yAxisStringency\");\n    this.ui.append(\"g\").attr(\"class\", \"yAxisPageviews\");\n\n    this.ui\n      .append(\"text\")\n      .attr(\"class\", \"yLabelStringency\")\n      .attr(\"text-anchor\", \"end\")\n      .attr(\"transform\", \"translate(15,0)rotate(-90)\")\n      .text(\"stringency index\");\n\n    this.ui\n      .append(\"text\")\n      .attr(\"class\", \"yLabelPageviews\")\n      .attr(\"text-anchor\", \"end\")\n      .text(\"pageviews\");\n\n    this.hoverLine = this.ui\n      .append(\"g\")\n      .append(\"rect\")\n      .attr(\"class\", \"hoverline\")\n      .attr(\"stroke-width\", \"1px\")\n      .attr(\"width\", \".5px\");\n\n    this.hoverLabel = this.ui.append(\"svg:text\");\n\n    this.hoverLabel\n      .text(\"\")\n      .style(\"text-anchor\", \"end\")\n      .style(\"fill\", \"black\")\n      .style(\"font-size\", 15);\n\n    const resize = () => {\n      this.update();\n    };\n    window.addEventListener(\"resize\", resize);\n  };\n\n  loadData<D>(tag: Tag): Promise<D> {\n    return new Promise<D>((resolve, reject) => {\n      this.props.incrementLoading();\n      d3.json<D>(tag.url)\n        .then((data) => {\n          if (data === undefined) return reject();\n          resolve(data);\n        })\n        .finally(() => this.props.decrementLoading());\n    });\n  }\n\n  componentDidUpdate(prevProps: TimelineProps, prevState: TimelineState) {\n    if (this.props.activeTags !== prevProps.activeTags) {\n      console.log(\"tags changed\");\n      const removeStringencies = Array.from(\n        this.state.stringencies.keys()\n      ).filter((s) => !this.props.activeTags.map((t) => t.title).includes(s));\n\n      const removeTopics = Array.from(this.state.topics.keys()).filter(\n        (s) => !this.props.activeTags.map((t) => t.title).includes(s)\n      );\n\n      if (removeStringencies.length + removeTopics.length > 0) {\n        this.setState((state) => {\n          removeStringencies.forEach((t) => state.stringencies.delete(t));\n          removeTopics.forEach((t) => state.topics.delete(t));\n          return state;\n        });\n        this.update(true);\n      }\n\n      for (let tag of this.props.activeTags) {\n        switch (tag.typ) {\n          case TagType.CountryStringency:\n            if (!(tag.title in this.state.topics)) {\n              this.loadData<CountryStringency>(tag).then((data) => {\n                this.setState((state) => {\n                  state.stringencies.set(tag.title, data);\n                  return state;\n                });\n                this.update(true);\n              });\n            }\n            break;\n          case TagType.CountryTotal:\n            if (!(tag.title in this.state.topics)) {\n              this.loadData<CountryTopicAttention>(tag).then((data) => {\n                this.setState((state) => {\n                  state.topics.set(tag.title, data);\n                  return state;\n                });\n                this.update(true);\n              });\n            }\n            break;\n          case TagType.CountryTopicAttention:\n            if (!(tag.title in this.state.topics)) {\n              this.loadData<CountryTopicAttention>(tag).then((data) => {\n                this.setState((state) => {\n                  state.topics.set(tag.title, data);\n                  return state;\n                });\n                this.update(true);\n              });\n            }\n            break;\n          default:\n            break;\n        }\n      }\n    }\n  }\n\n  componentDidMount() {\n    this.addTimeline();\n    this.update(true);\n  }\n\n  render() {\n    return (\n      <div className=\"Timeline\">\n        <div className=\"\" id=\"timeline-container\"></div>\n        <div className=\"notes h-20 px-2 overflow-y-scroll text-gray-500 text-xs\">\n          {this.state.notes}\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default connector(Timeline);\n","import React from \"react\";\nimport { Route, Link } from \"react-router-dom\";\nimport WorldMap from \"./Map\";\nimport TopicBarPlot from \"./TopicBarPlot\";\nimport Timeline from \"./Timeline\";\nimport { connect, ConnectedProps } from \"react-redux\";\nimport { TagType, Tag } from \"./store/reducers/tags\";\nimport { Action } from \"./store/actions\";\nimport { RootState } from \"./store\";\nimport { shuffleArray } from \"./utils\";\nimport LANGUAGE_COUNTRIES from \"./data/languages_countries.json\";\nimport SELECTED_TOPICS from \"./data/selected_topics.json\";\nimport \"./App.sass\";\n\nconst mapState = (state: RootState) => ({\n  activeTags: state.tags.activeTags,\n});\n\nconst mapDispatch = {\n  addTag: (tag: Tag) => ({\n    type: Action.AddTag,\n    payload: {\n      tag,\n    },\n  }),\n  removeTag: (tag: Tag) => ({\n    type: Action.RemoveTag,\n    payload: {\n      tag,\n    },\n  }),\n};\n\nconst connector = connect(mapState, mapDispatch);\ntype PropsFromRedux = ConnectedProps<typeof connector>;\n\ntype MainState = {\n  availableTags: Tag[];\n  searchText: string;\n};\n\ninterface MainProps extends PropsFromRedux {}\n\nconst tagColor = (typ: TagType): string => {\n  let tagColor = \"bg-red-200 text-red-700\";\n  switch (typ) {\n    case TagType.CountryTotal:\n      tagColor = \"bg-gray-200 text-gray-700\";\n      break;\n    case TagType.CountryTopicAttention:\n      tagColor = \"bg-blue-200 text-blue-700\";\n      break;\n    default:\n      break;\n  }\n  return tagColor;\n};\n\nclass Main extends React.Component<MainProps, MainState> {\n  constructor(props: MainProps) {\n    super(props);\n    const availableTags: Tag[] = [];\n    const map = new Map();\n    LANGUAGE_COUNTRIES.forEach((lc) => {\n      const country = lc.country.toLowerCase();\n      const group = lc.group.toLowerCase();\n      const base = `data/${group}/${country}`;\n\n      let title = `${country.toUpperCase().replaceAll(\" \", \"-\")}:STRINGENCY`;\n      if (!map.has(title)) {\n        availableTags.push({\n          typ: TagType.CountryStringency,\n          country: lc.country,\n          lang: lc.group,\n          iso3: lc.iso3,\n          url: `${base}/stringency_changepoints.json`,\n          title,\n        });\n        map.set(title, true);\n      }\n      title = `${country\n        .toUpperCase()\n        .replaceAll(\" \", \"-\")\n        .toUpperCase()}:TOTAL`;\n      if (!map.has(title)) {\n        availableTags.push({\n          typ: TagType.CountryTotal,\n          country: lc.country,\n          lang: lc.group,\n          iso3: lc.iso3,\n          url: `${base}/total.json`,\n          title,\n        });\n        map.set(title, true);\n      }\n      SELECTED_TOPICS.forEach((topic) => {\n        title = `${country\n          .toUpperCase()\n          .replaceAll(\" \", \"-\")}:TOPIC:${topic.toUpperCase()}`;\n        if (!map.has(title)) {\n          availableTags.push({\n            typ: TagType.CountryTopicAttention,\n            country: lc.country,\n            lang: lc.group,\n            iso3: lc.iso3,\n            url: `${base}/topics/${topic.toLowerCase()}.json`,\n            title,\n          });\n          map.set(title, true);\n        }\n      });\n    });\n    // console.log(availableTags);\n    shuffleArray(availableTags);\n    this.state = {\n      availableTags,\n      searchText: \"\",\n    };\n  }\n\n  handleUpdateSearchText = (event: React.ChangeEvent<HTMLInputElement>) => {\n    this.setState({ searchText: event.target.value });\n  };\n\n  componentDidMount() {\n    const initialSelection = [\"ITALY:STRINGENCY\", \"ITALY:TOPIC:MEDICINE\"];\n    // const initialSelection = [\"GERMANY:STRINGENCY\", \"ITALY:TOPIC:MEDICINE\"];\n    this.state.availableTags\n      .filter((t) => initialSelection.includes(t.title))\n      .filter((t) => !this.props.activeTags.some((tt) => t.title === tt.title))\n      .forEach((t) => {\n        console.log(\"adding\", t);\n        this.props.addTag(t);\n      });\n  }\n\n  render() {\n    const activeTags = this.props.activeTags.map((tag) => {\n      return (\n        <div\n          key={tag.title}\n          onClick={() => this.props.removeTag(tag)}\n          className={\n            \"text-xs inline-flex opacity-75 hover:opacity-100 cursor-pointer items-center font-bold leading-sm uppercase px-3 py-1 m-1 rounded-full \" +\n            tagColor(tag.typ)\n          }\n        >\n          <svg\n            xmlns=\"http://www.w3.org/2000/svg\"\n            className=\"h-3 w-3\"\n            fill=\"none\"\n            viewBox=\"0 0 24 24\"\n            stroke=\"currentColor\"\n          >\n            <path\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n              strokeWidth=\"2\"\n              d=\"M6 18L18 6M6 6l12 12\"\n            />\n          </svg>\n          {tag.title}\n        </div>\n      );\n    });\n\n    const longestPrefix = (words: string[]): number => {\n      if (!words[0]) return 0;\n      if (words.length === 1) return words[0].length;\n\n      let i = 0;\n      let done = false;\n      // avoid unsafe use of variable i by using a for loop\n      while (words[0][i]) {\n        for (let w of words) {\n          if (w[i] !== words[0][i]) {\n            done = true;\n            break;\n          }\n        }\n        if (done) break;\n        i++;\n      }\n\n      return words[0].substr(0, i).length;\n    };\n\n    const searchMatchScorer = (query: string[], tag: string[]): number => {\n      let totalScore = 0;\n      while (query.length > 0 && tag.length > 0) {\n        let maxScore = 0;\n        let maxQi = 0;\n        let maxTi = 0;\n        for (let ti in tag) {\n          for (let qi in query) {\n            let score = longestPrefix([query[qi], tag[ti]]);\n            if (score >= maxScore) {\n              maxScore = score;\n              maxQi = Number(qi);\n              maxTi = Number(ti);\n            }\n          }\n        }\n        totalScore += maxScore;\n        query.splice(maxQi, 1);\n        tag.splice(maxTi, 1);\n      }\n      return totalScore;\n    };\n\n    const searchPrefixes = this.state.searchText\n      .toLowerCase()\n      .replaceAll(\":\", \" \")\n      .split(\" \")\n      .filter((s) => s.length > 0);\n\n    const availableTags: [Tag, number][] = this.state.availableTags\n      .filter((t) => {\n        return !this.props.activeTags.map((tt) => tt.title).includes(t.title);\n      })\n      .map((t) => {\n        return [\n          t,\n          searchMatchScorer(\n            [...searchPrefixes],\n            t.title.toLowerCase().split(\":\")\n          ),\n        ];\n      });\n\n    const scoredAvailableTags = availableTags\n      .sort(([a, scoreA], [b, scoreB]) => {\n        return scoreB - scoreA;\n      })\n      .slice(0, 8)\n      .map(([tag, _]) => {\n        return (\n          <div\n            key={tag.title}\n            onClick={() => this.props.addTag(tag)}\n            className={\n              \"text-xs inline-flex opacity-75 hover:opacity-100 cursor-pointer items-center font-normal leading-sm max-w-full break-all uppercase pl-1 pr-2 py-1 m-1 rounded-full \" +\n              tagColor(tag.typ)\n            }\n          >\n            <svg\n              xmlns=\"http://www.w3.org/2000/svg\"\n              className=\"h-3 w-3\"\n              fill=\"none\"\n              viewBox=\"0 0 24 24\"\n              stroke=\"currentColor\"\n            >\n              <path\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n                strokeWidth=\"2\"\n                d=\"M12 6v6m0 0v6m0-6h6m-6 0H6\"\n              />\n            </svg>\n            {tag.title}\n          </div>\n        );\n      });\n\n    const tabStyle = \"font-semibold bg-white inline-block py-1 px-2 \";\n    const selectedTabStyle =\n      tabStyle +\n      \"cursor-pointer text-gray-800 border-l border-t border-r rounded-t\";\n    // const unselectedTabStyle =\n    //   tabStyle + \"cursor-pointer text-gray-300 hover:text-gray-800\";\n    const disabledTabStyle =\n      tabStyle + \" text-gray-200 cursor-default hover:text-gray-200\";\n\n    return (\n      <div className=\"Main\">\n        <div className=\"flex\">\n          <div className=\"tags\">{activeTags}</div>\n        </div>\n        <div className=\"flex\">\n          <div className=\"w-3/4 inline-block\">\n            <Timeline />\n          </div>\n          <div className=\"w-1/4 inline-block px-2 py-1\">\n            <input\n              className=\"focus:border-light-blue-500 focus:ring-1 focus:ring-light-blue-500 focus:outline-none w-full text-sm text-black placeholder-gray-500 border border-gray-200 rounded-md py-2 pl-1\"\n              type=\"text\"\n              value={this.state.searchText}\n              onChange={this.handleUpdateSearchText}\n              aria-label=\"Search\"\n              placeholder=\"Search\"\n            />\n            <div>\n              <div className=\"tags overflow-y-scroll\">\n                {scoredAvailableTags}\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <ul className=\"flex border-b\">\n          <li className=\"-mb-px ml-2\">\n            <Link className={selectedTabStyle} to=\"/\">\n              Attention Shift\n            </Link>\n          </li>\n\n          <li className=\"ml-2\">\n            <Link\n              onClick={(event) => event.preventDefault()}\n              className={disabledTabStyle}\n              to=\"/map\"\n            >\n              Map\n            </Link>\n          </li>\n        </ul>\n        <div className=\"tabContent mb-5\">\n          <Route exact path=\"/map\" component={WorldMap} />\n          <Route exact path=\"/\" component={TopicBarPlot} />\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default connector(Main);\n","import React from \"react\";\n\ntype AboutProps = {};\ntype AboutState = {};\n\nexport default class About extends React.Component<AboutProps, AboutState> {\n  state: AboutState = {};\n\n  render() {\n    return (\n      <div className=\"About\">\n        This is an about page\n      </div>\n    )\n  }\n}\n","export default __webpack_public_path__ + \"static/media/covid19_2.f14dc517.jpg\";","export default __webpack_public_path__ + \"static/media/VU_2.97ce354c.png\";","import React from \"react\";\nimport { HashRouter as Router, Route, Link } from \"react-router-dom\";\nimport Main from \"./Main\";\nimport About from \"./About\";\nimport covidLogo from \"./images/covid19_2.jpg\";\nimport vuLogo from \"./images/VU_2.png\";\nimport \"./App.sass\";\nimport { connect, ConnectedProps } from \"react-redux\";\nimport { RootState } from \"./store\";\n\nconst mapState = (state: RootState) => ({\n  loadingCount: state.loading?.loadingCount,\n});\n\nconst mapDispatch = {};\n\nconst connector = connect(mapState, mapDispatch);\ntype PropsFromRedux = ConnectedProps<typeof connector>;\n\ninterface AppProps extends PropsFromRedux {}\ntype AppState = {};\n\nclass App extends React.Component<AppProps, AppState> {\n  constructor(props: AppProps) {\n    super(props);\n    this.state = {\n      loading: true,\n    };\n  }\n\n  render() {\n    return (\n      <div className=\"App\">\n        <Router>\n          <nav className=\"flex items-center justify-between flex-wrap bg-blue-300 p-2\">\n            <Link\n              to=\"/\"\n              className=\"flex items-center flex-shrink-1 text-white mr-4\"\n            >\n              <img\n                className=\"rounded-full max-h-6 p-0 mr-2\"\n                alt=\"Covid-19 Logo\"\n                src={covidLogo}\n              />\n              <span className=\"font-semibold text-l tracking-tight text-black\">\n                COVID-19 Wikipedia Attention\n              </span>\n            </Link>\n            <div className=\"block flex-grow flex items-center place-items-start w-auto\">\n              <div className=\"text-sm flex-grow\">\n                {/* <Link\n                  className=\"block inline-block mt-0 text-teal-200 hover:text-white mr-4\"\n                  to=\"/about\"\n                >\n                  About\n                </Link> */}\n              </div>\n              <div className=\"mr-3\">\n                {this.props.loadingCount > 0 && (\n                  <div className=\"block animate-spin h-4 w-4 rounded-full border-b-2 border-gray-900\"></div>\n                )}\n              </div>\n              <div className=\"mr-1\">\n                <a href=\"https://vu.nl\">\n                  <img\n                    className=\"inline-block rounded-full max-h-6 p-0 bg-white px-2\"\n                    alt=\"VU University Logo\"\n                    src={vuLogo}\n                  />\n                </a>\n              </div>\n              <div>\n                <a\n                  href=\"https://github.com/romnn/lsde2021\"\n                  className=\"inline-block text-sm px-4 py-2 leading-none border rounded text-black border-transparent hover:border-white\"\n                >\n                  GitHub\n                </a>\n              </div>\n            </div>\n          </nav>\n\n          <Route exact path=\"/\" component={Main} />\n          <Route exact path=\"/about\" component={About} />\n        </Router>\n      </div>\n    );\n  }\n}\n\nexport default connector(App);\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import { Tag } from \"./tags\";\nimport { Action } from \"../actions\";\nimport { AnyAction } from \"redux\";\n\ntype ChangepointState = {\n  readonly changepoint: Date | undefined;\n  readonly tag: Tag | undefined;\n};\n\nconst initialState: ChangepointState = {\n  changepoint: undefined,\n  tag: undefined,\n};\n\nexport type { ChangepointState };\n\nexport default function changepointReducer(\n  state = initialState,\n  action: AnyAction\n) {\n  switch (action.type) {\n    case Action.SelectChangepoint: {\n      const { changepoint, tag } = action.payload;\n      return {\n        ...state,\n        changepoint,\n        tag,\n      };\n    }\n\n    default:\n      return state;\n  }\n}\n","import { Action } from \"../actions\";\nimport { AnyAction } from \"redux\";\n\ntype LoadingState = {\n  readonly loadingCount: number;\n};\n\nconst initialState: LoadingState = {\n  loadingCount: 0,\n};\n\nexport type { LoadingState };\n\nexport default function loadingReducer(\n  state = initialState,\n  action: AnyAction\n) {\n  switch (action.type) {\n    case Action.IncrementLoading: {\n      return {\n        ...state,\n        loadingCount: state.loadingCount + 1,\n      };\n    }\n    case Action.DecrementLoading: {\n      return {\n        ...state,\n        loadingCount: state.loadingCount - 1,\n      };\n    }\n\n    default:\n      return state;\n  }\n}\n","import { combineReducers } from \"redux\";\nimport tags from \"./tags\";\nimport changepoints from \"./changepoints\";\nimport loading from \"./loading\";\n\nexport default combineReducers({ tags, changepoints, loading });\n","import { createStore } from \"redux\";\nimport rootReducer from \"./reducers\";\n\nconst store = createStore(rootReducer);\n\nexport type RootState = ReturnType<typeof store.getState>\n\nexport default store;\n// export { initialState, Action };\n// export type {  RootState };\n// import { createSlice, configureStore } from \"@reduxjs/toolkit\";\n\n// enum TagType {\n//   CountryStringency,\n//   CountryTopicAttention,\n//   CountryTotal,\n// }\n\n// type Tag = {\n//   typ: TagType;\n//   title: string;\n// };\n\n// type StoreState = {\n//   loading: number;\n//   activeTags: Tag[];\n// };\n\n// export { TagType };\n// export type { Tag };\n\n// // export const addTodo = (tag: Tag) => ({\n// //   type: Action.AddTODO,\n// //   payload: {\n// //     id: 0,\n// //     tag,\n// //   },\n// // });\n\n// const counterSlice = createSlice({\n//   name: \"counter\",\n//   initialState: {\n//     loading: 0,\n//     activeTagTitles: [],\n//   },\n//   reducers: {\n//     incrementLoading: (state) => {\n//       state.loading += 1;\n//     },\n//     decrementedLoading: (state) => {\n//       state.loading = Math.max(0, state.loading - 1);\n//     },\n//     // addTag: (state, tag) => {\n//     //   state.activeTagTitles.push(tag.title);\n//     // },\n//     // removeTag: (state, title) => {\n//     //   state.activeTagTitles = state.activeTagTitles.filter((t) => {\n//     //     return title !== t;\n//     //   });\n//     // },\n//   },\n// });\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport reportWebVitals from \"./reportWebVitals\";\nimport { Provider } from \"react-redux\";\nimport store from \"./store/index\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <App />\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}